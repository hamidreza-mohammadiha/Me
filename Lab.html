<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Strategies Compass ‚Äî Split Layout + Responsive + Trails</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
  <style>
    :root{
      --bg:#0b1020; --panel:#121a33; --ink:#e9eefc; --muted:#9fb2e4;
      --accent:#6ea8fe; --grid:#1c2647; --outline: rgba(255,255,255,.06);
      --card:#0f1730;
    }
    html,body{height:100%}
    body{
      margin:0; background:var(--bg); color:var(--ink);
      font-family: ui-sans-serif, system-ui, "Segoe UI", Roboto,
                   "Apple Color Emoji","Segoe UI Emoji","Noto Color Emoji", sans-serif;
      display:grid; grid-template-rows:auto auto auto auto; gap:14px; padding:14px;
    }

    header{
      background:linear-gradient(180deg, #0f1430 0%, #0b1020 100%);
      border:1px solid var(--grid); border-radius:16px; padding:18px;
      box-shadow: 0 10px 30px rgba(0,0,0,.25), inset 0 1px 0 var(--outline);
    }
    header h1{margin:0 0 6px 0; font-size:22px}
    header p{margin:0; color:var(--muted); font-size:14px}

    .desc{
      padding:14px 16px; display:grid; gap:10px;
      background:var(--panel); border:1px solid var(--grid); border-radius:16px;
      box-shadow: 0 10px 30px rgba(0,0,0,.25), inset 0 1px 0 var(--outline);
    }
    .desc p{margin:0; color:var(--muted); font-size:14px; line-height:1.6}
    .quote{font-style:italic; color:#cfe1ff}

    /* -------- Split layout (equal heights, 33% / 67%) -------- */
    .mainGrid{
      display:grid;
      grid-template-columns: 33% 67%;
      gap:14px;
      align-items: stretch;       /* make both items equal height */
    }
    @media (max-width: 900px){
      .mainGrid{ grid-template-columns: 1fr; }
    }

    .panel{
      background:var(--panel); border:1px solid var(--grid);
      border-radius:16px; padding:12px 14px;
      box-shadow: 0 10px 30px rgba(0,0,0,.25), inset 0 1px 0 var(--outline);
      display:flex; flex-wrap:wrap; gap:14px; align-items:center;
      height:100%;                /* stretch to grid row height */
      margin: 1%;
      padding: 10px;
      
    }
    .group{display:flex; align-items:center; gap:10px}
    .group label{font-size:14px; color:var(--muted)}
    input[type="range"]{accent-color:var(--accent)}
    .value-pill{
      background:rgba(110,168,254,.15); color:#cfe1ff; padding:4px 8px;
      border-radius:999px; font-variant-numeric:tabular-nums;
      border:1px solid rgba(110,168,254,.35);
    }
    select,button{
      background:#0f1730; border:1px solid var(--grid); color:var(--ink);
      padding:8px 10px; border-radius:10px;
    }
    button:hover{border-color:var(--accent)}
    .hint{color:var(--muted); font-size:12px}
    .checkbox{display:flex; align-items:center; gap:8px}

    .chartPane{
      background:linear-gradient(180deg, #0f1430 0%, #0b1020 100%);
      border:1px solid var(--grid); border-radius:16px;
      box-shadow: inset 0 0 0 1px var(--outline), 0 12px 40px rgba(0,0,0,.35);
      padding:-20px;
      height:100%;                /* stretch to grid row height */
      display:flex;               /* allow inner chart to size nicely */
      margin: 1%;
    }
    #chart{ width:100%; height:auto; aspect-ratio: 16 / 10; }

    /* Cards grid below */
    .grid{
      display:grid;
      grid-template-columns:repeat(auto-fit, minmax(280px, 1fr));
      gap:14px;
    }
    .card{
      background:var(--panel); border:1px solid var(--grid); border-radius:16px;
      box-shadow: 0 10px 30px rgba(0,0,0,.25), inset 0 1px 0 var(--outline);
      padding:14px 16px;
    }
    .card h3{margin:0 0 6px 0; font-size:16px}
    .badge{font-size:12px; color:#b9ccff}
    .card ul{margin:8px 0 0 16px; color:#cfe1ff}
    .card p{margin:6px 0; color:#cfe1ff}

    footer{color:var(--muted); font-size:12px; padding:4px 2px}
  </style>
</head>
<body>
  <header>
    <h1>Strategies on the Decision Compass</h1>
    <!-- <p>Desktop: split layout (left settings ‚Ä¢ right chart). Mobile: stacked. Cards live below.</p> -->
  </header>

  <section class="desc">
    <p style="text-align: justify;"><strong>How this simulation works:</strong><br> each emoji is a tiny ‚Äúagent‚Äù moving on a map. Every tick (about 3 times per second) we update its position. In <em>Random</em> mode it wiggles with small random steps controlled by the Risk slider. In <em>Wise</em> mode it follows gentle rules: it keeps some momentum (experience), drifts a little toward the center (good advice), avoids bumping others (awareness), leans toward its favorite home spot (identity), stays away from the edges (safety), and adds a tiny curiosity nudge so it never gets stuck. The colored trail shows where it just came from.</p>
    <p class="quote">‚ÄúOne thing about us wise guys, the hustle never ends.‚Äù ‚Äî Tony Soprano</p>
  </section>

  <section class="mainGrid" aria-label="Main split layout">
    <!-- Left: Settings -->
    <div class="panel" role="region" aria-label="Controls">
      <div class="group">
        <label for="mode">Animation</label>
        <select id="mode" aria-label="Animation Mode">
          <option>Random</option>
          <option selected>Wise</option>
        </select>
      </div>

      <div class="group">
        <label for="risk">Risk-Taking Index</label>
        <input id="risk" type="range" min="25" max="75" value="50" step="1" />
        <span id="riskVal" class="value-pill">50%</span>
      </div>

      <div class="group">
        <label for="trailLen">Trail length</label>
        <input id="trailLen" type="range" min="10" max="250" value="80" step="1" />
        <span id="trailVal" class="value-pill">80</span>
      </div>

      <div class="group checkbox">
        <input id="showTrails" type="checkbox" checked />
        <label for="showTrails">Show trails</label>
      </div>

      <div class="group checkbox">
        <input id="eqBias" type="checkbox" checked />
        <label for="eqBias">Equilibrium bias</label>
      </div>

      <div class="group checkbox">
        <input id="edgeSafe" type="checkbox" checked />
        <label for="edgeSafe">Edge safety</label>
      </div>

      <div class="group">
        <button id="reset">Reset positions</button>
        <button id="pausePlay">Pause</button>
      </div>

      <div class="group">
        <span class="hint">Wise = momentum + center + separation + equilibrium + edge + curiosity.</span>
      </div>
    </div>



    <!-- Right: Chart -->
    <div class="chartPane">
      <div id="chart" role="img" aria-label="Animated strategies on 2D compass"></div>
    </div>
  </section>
  <br>

  <!-- Strategy Cards Below -->
  <section class="grid" aria-label="Strategy Definitions">
    <article class="card"><h3 style="text-align: justify;">üëë Empire <span class="badge">Achiever ‚Ä¢ Rational ‚Ä¢ Stable</span></h3>
      <p><strong>Build structured dominance</strong> via planning/hierarchy/standards.</p>
      <ul>
        <li><em>Ops:</em> ERP rollout, SOP unification.</li>
        <li><em>Business:</em> Platform consolidation, M&A integration.</li>
        <li><em>Lifestyle:</em> Routines, budgeting, compounding habits.</li>
      </ul>
    </article>

    <article class="card"><h3 style="text-align: justify;">üõ°Ô∏è Fortress <span class="badge">Socializer ‚Ä¢ Fair ‚Ä¢ Stable</span></h3>
      <p><strong>Protect core assets</strong>; reliability, compliance, safety nets.</p>
      <ul>
        <li><em>Ops:</em> Redundancy, QA hardening, incident response.</li>
        <li><em>Business:</em> Reg-first design, trust & safety.</li>
        <li><em>Lifestyle:</em> Emergency fund, insurance, sleep hygiene.</li>
      </ul>
    </article>

    <article class="card"><h3 style="text-align: justify;">üå≤ Guerrilla <span class="badge">Socializer/Explorer ‚Ä¢ Fair ‚Ä¢ Flexible</span></h3>
      <p><strong>Small, adaptive units</strong>; exploit asymmetry; iterate fast.</p>
      <ul>
        <li><em>Ops:</em> Skunkworks pilots, A/B tests.</li>
        <li><em>Business:</em> Niche markets, community growth.</li>
        <li><em>Lifestyle:</em> Minimal gear, test-learn loops.</li>
      </ul>
    </article>

    <article class="card"><h3 style="text-align: justify;">‚ö° Blitzkrieg <span class="badge">Killer ‚Ä¢ Rational ‚Ä¢ Flexible</span></h3>
      <p><strong>Time-boxed offensives</strong> to seize advantage fast.</p>
      <ul>
        <li><em>Ops:</em> War-room sprints, launch surges.</li>
        <li><em>Business:</em> Hype windows, speed-to-market.</li>
        <li><em>Lifestyle:</em> Sprint-then-recover cycles.</li>
      </ul>
    </article>

    <article class="card"><h3 style="text-align: justify;">üêé Cavalry <span class="badge">Achiever/Socializer ‚Ä¢ Coordinated ‚Ä¢ Agile</span></h3>
      <p><strong>Fast maneuver support</strong> that links and rescues units.</p>
      <ul>
        <li><em>Ops:</em> Rapid response squads, cross-functional strikes.</li>
        <li><em>Business:</em> Partner enablement, field assists.</li>
        <li><em>Lifestyle:</em> Accountability partners, study groups.</li>
      </ul>
    </article>

    <article class="card"><h3 style="text-align: justify;">üó°Ô∏è Gladiator <span class="badge">Achiever/Killer ‚Ä¢ Individual mastery</span></h3>
      <p><strong>Head-to-head excellence</strong>; mastery of tools & timing.</p>
      <ul>
        <li><em>Ops:</em> Top-gun troubleshooters, on-call champions.</li>
        <li><em>Business:</em> Key-account closers, demo stars.</li>
        <li><em>Lifestyle:</em> Deliberate practice, tournaments.</li>
      </ul>
    </article>

    <article class="card"><h3 style="text-align: justify;">üêô Shapeshifter <span class="badge">Explorer ‚Ä¢ Adaptive ‚Ä¢ Very flexible</span></h3>
      <p><strong>Form-changing to fit context</strong>; polymath reframing.</p>
      <ul>
        <li><em>Ops:</em> Role rotation, modular architecture.</li>
        <li><em>Business:</em> Pivots, option portfolios.</li>
        <li><em>Lifestyle:</em> Skill stacks, seasonal routines.</li>
      </ul>
    </article>

    <article class="card"><h3 style="text-align: justify;">üÉè Trickster <span class="badge">Killer/Explorer ‚Ä¢ Creative disruption</span></h3>
      <p><strong>Subvert expectations</strong>; misdirection; playful norms.</p>
      <ul>
        <li><em>Ops:</em> Chaos testing, red-team drills.</li>
        <li><em>Business:</em> Category judo, meme campaigns.</li>
        <li><em>Lifestyle:</em> Humor leverage, constraint hacks.</li>
      </ul>
    </article>
  </section>

  <footer>
    A Play by: <a href="https://hamidreza-mohammadiha.github.io/Me/">Hamidreza</a>
    <br><br>
  </footer>

  <script>
    // ====== Helpers ======
    const clamp01 = v => Math.max(0, Math.min(1, v));

    // ====== Emoji-only agents with equilibrium "home" and colors ======
    const agents = [
      { label:"üëë",  color:"#A6CEE3", home:[0.75,0.25], gravitas:1.30 }, // Empire
      { label:"üõ°Ô∏è", color:"#1F78B4", home:[0.25,0.20], gravitas:1.40 }, // Fortress
      { label:"üå≤",  color:"#B2DF8A", home:[0.30,0.70], gravitas:1.05 }, // Guerrilla
      { label:"‚ö°",  color:"#FB9A99", home:[0.88,0.80], gravitas:1.10 }, // Blitzkrieg
      { label:"üêé",  color:"#CAB2D6", home:[0.60,0.70], gravitas:1.10 }, // Cavalry
      { label:"üó°Ô∏è", color:"#FDBF6F", home:[0.80,0.45], gravitas:1.20 }, // Gladiator
      { label:"üêô",  color:"#E31A1C", home:[0.50,0.82], gravitas:1.00 }, // Shapeshifter
      { label:"üÉè",  color:"#33A02C", home:[0.70,0.78], gravitas:1.05 }, // Trickster
    ];
    const N = agents.length;

    // Start near home with slight jitter
    let positions = agents.map(a => [
      clamp01(a.home[0] + (Math.random()-0.5)*0.06),
      clamp01(a.home[1] + (Math.random()-0.5)*0.06)
    ]);
    let velocities = Array.from({length:N}, () => [0,0]);

    // ====== UI elements ======
    const modeEl = document.getElementById('mode');
    const riskEl = document.getElementById('risk');
    const riskVal = document.getElementById('riskVal');
    const trailLenEl = document.getElementById('trailLen');
    const trailVal = document.getElementById('trailVal');
    const showTrailsEl = document.getElementById('showTrails');
    const eqBiasEl = document.getElementById('eqBias');
    const edgeSafeEl = document.getElementById('edgeSafe');
    const resetBtn = document.getElementById('reset');
    const pausePlayBtn = document.getElementById('pausePlay');

    riskEl.addEventListener('input', ()=> riskVal.textContent = `${riskEl.value}%`);
    trailLenEl.addEventListener('input', ()=> trailVal.textContent = `${trailLenEl.value}`);

    resetBtn.addEventListener('click', ()=>{
      positions = agents.map(a => [
        clamp01(a.home[0] + (Math.random()-0.5)*0.06),
        clamp01(a.home[1] + (Math.random()-0.5)*0.06)
      ]);
      velocities = Array.from({length:N}, () => [0,0]);
      // reset trails to new start points
      for (let i=0;i<N;i++){
        Plotly.restyle('chart', {x:[[positions[i][0]]], y:[[positions[i][1]]]}, [i]);
      }
      draw(true);
    });

    let paused=false;
    pausePlayBtn.addEventListener('click', ()=>{
      paused=!paused;
      pausePlayBtn.textContent = paused ? "Play" : "Pause";
    });

    // ====== Plotly setup ======
    const layout = {
      paper_bgcolor: 'rgba(0,0,0,0)',
      plot_bgcolor: 'rgba(0,0,0,0)',
      xaxis: {
        range:[0,1],
        title:{text:"Axis 1: Individual Rationality ‚Üí Collective Fairness", font:{color:"#cfe1ff"}},
        gridcolor:"#1c2647", zeroline:false, color:"#e9eefc"
      },
      yaxis: {
        range:[0,1],
        title:{text:"Axis 2: Stability ‚Üí Flexibility", font:{color:"#cfe1ff"}},
        gridcolor:"#1c2647", zeroline:false, color:"#e9eefc"
      },
      margin:{t:10,l:60,r:20,b:60}
    };

    // Trails (one per agent)
    const trailTraces = agents.map((a,i)=>({
      x:[positions[i][0]], y:[positions[i][1]],
      mode:"lines", type:"scatter",
      line:{color:a.color, width:2}, opacity:0.85,
      hoverinfo:"none", showlegend:false
    }));

    // Equilibrium markers (home targets)
    const eqTrace = {
      x: agents.map(a=>a.home[0]),
      y: agents.map(a=>a.home[1]),
      mode: "markers",
      type: "scatter",
      marker: { size: 8, color: agents.map(a=>a.color), symbol:"x", opacity:0.65, line:{color:"#101425", width:1} },
      hoverinfo: "none", showlegend:false
    };

    // Live dots + emoji text
    const dotsTrace = {
      x: positions.map(p=>p[0]),
      y: positions.map(p=>p[1]),
      mode: "markers",
      type: "scatter",
      marker: { size: 11, color: agents.map(a=>a.color), opacity: 0.95, line:{color:"#101425", width:1} },
      hoverinfo: "none", showlegend:false
    };
    const textTrace = {
      x: positions.map(p=>p[0]),
      y: positions.map(p=>p[1]),
      mode: "text",
      type: "scatter",
      text: agents.map(a=>a.label),
      textfont: { size: 22, color: "#e9eefc" },
      hoverinfo: "none", showlegend:false
    };

    Plotly.newPlot("chart", [...trailTraces, eqTrace, dotsTrace, textTrace], layout,
                   {responsive:true, displayModeBar:false});

    const trailIdxs = [...Array(N).keys()]; // 0..N-1
    const dotsIdx   = N+1;
    const textIdx   = N+2;

    // ====== Motion models ======
    function randomPositions(pos, riskPct){
      const r = Math.max(25, Math.min(75, riskPct));
      const step = 0.004 + (r - 25) * (0.012 - 0.004) / 50; // 25‚Äì75% ‚Üí 0.004‚Äì0.012
      return pos.map(([x,y])=>{
        const dx = (Math.random()-0.5)*2*step;
        const dy = (Math.random()-0.5)*2*step;
        return [clamp01(x+dx), clamp01(y+dy)];
      });
    }

    function wisePositions(pos, vel, riskPct){
      const r = Math.max(25, Math.min(75, riskPct));
      const rn = (r - 25) / 50; // 0..1 (risk-averse ‚Üí risk-seeking)

      const curiosity  = 0.0015 + rn * 0.0035;   // exploration, never zero
      const inertia    = 0.86 + rn * 0.08;       // momentum (experience)
      const centerPull = 0.020 * (1 - rn);       // advice toward center
      const sepRadius  = 0.12 - rn * 0.04;       // separation radius
      const sepStrength= 0.030 + rn * 0.015;     // separation strength
      const maxSpeed   = 0.015;                  // sensible cap
      const homeKBase  = 0.020 * (1 - rn);       // home equilibrium bias
      const edgeK      = 0.040;                  // edge safety strength
      const edgeM      = 0.02;                   // edge margin

      const cx=0.5, cy=0.5;

      for (let i=0;i<N;i++){
        let [x,y] = pos[i];
        let [vx,vy] = vel[i];

        // curiosity
        let nx = (Math.random()-0.5)*2*curiosity;
        let ny = (Math.random()-0.5)*2*curiosity;

        // center pull
        let ax = (cx - x) * centerPull;
        let ay = (cy - y) * centerPull;

        // equilibrium (home) bias
        let hx = 0, hy = 0;
        if (eqBiasEl.checked){
          const home = agents[i].home;
          const homeK = homeKBase * (0.85 + 0.3*Math.random());
          hx = (home[0] - x) * homeK;
          hy = (home[1] - y) * homeK;
        }

        // separation with gravitas
        let sx=0, sy=0;
        for (let j=0;j<N;j++){
          if (i===j) continue;
          const dx = x - pos[j][0];
          const dy = y - pos[j][1];
          const d2 = dx*dx + dy*dy;
          if (d2>0){
            const d = Math.sqrt(d2);
            if (d < sepRadius){
              const weight = agents[j].gravitas;
              const f = sepStrength * (sepRadius - d) / sepRadius * weight;
              sx += (dx/d) * f;
              sy += (dy/d) * f;
            }
          }
        }

        // edge safety
        let ex=0, ey=0;
        if (edgeSafeEl.checked){
          if (x < edgeM) ex += (edgeM - x) * edgeK;
          if (x > 1-edgeM) ex -= (x - (1-edgeM)) * edgeK;
          if (y < edgeM) ey += (edgeM - y) * edgeK;
          if (y > 1-edgeM) ey -= (y - (1-edgeM)) * edgeK;
        }

        // combine & cap
        vx = vx*inertia + nx + ax + hx + sx + ex;
        vy = vy*inertia + ny + ay + hy + sy + ey;

        const sp = Math.hypot(vx,vy);
        if (sp > maxSpeed){
          vx = (vx/sp)*maxSpeed;
          vy = (vy/sp)*maxSpeed;
        }

        x = clamp01(x + vx);
        y = clamp01(y + vy);

        pos[i] = [x,y];
        vel[i] = [vx,vy];
      }
      return {pos, vel};
    }

    // ====== Animation ======
    const intervalMs = 100;

    function tick(){
      if (paused) return;
      const risk = Number(riskEl.value);
      if (modeEl.value === "Random"){
        positions = randomPositions(positions, risk);
      } else {
        const res = wisePositions(positions, velocities, risk);
        positions = res.pos; velocities = res.vel;
      }
      draw(false);
    }

    function draw(forceRedrawTrails){
      const xs = positions.map(p=>p[0]);
      const ys = positions.map(p=>p[1]);

      Plotly.restyle('chart', {x:[xs], y:[ys]}, [N+1]); // dots
      Plotly.restyle('chart', {x:[xs], y:[ys], text:[agents.map(a=>a.label)]}, [N+2]); // labels

      if (showTrailsEl.checked || forceRedrawTrails){
        const xExt = positions.map(p=>[p[0]]);
        const yExt = positions.map(p=>[p[1]]);
        const maxPts = Number(trailLenEl.value);
        Plotly.extendTraces('chart', {x:xExt, y:yExt}, [...Array(N).keys()], maxPts);
      }
    }

    Plotly.newPlot("chart",
      [
        ...trailTraces,   // 0..N-1
        { /* equilibrium markers */ 
          x: agents.map(a=>a.home[0]),
          y: agents.map(a=>a.home[1]),
          mode: "markers", type: "scatter",
          marker: { size: 8, color: agents.map(a=>a.color), symbol:"x", opacity:0.65, line:{color:"#101425", width:1} },
          hoverinfo: "none", showlegend:false
        },
        { /* dots */
          x: positions.map(p=>p[0]),
          y: positions.map(p=>p[1]),
          mode: "markers", type: "scatter",
          marker: { size: 11, color: agents.map(a=>a.color), opacity: 0.95, line:{color:"#101425", width:1} },
          hoverinfo: "none", showlegend:false
        },
        { /* emoji labels */
          x: positions.map(p=>p[0]),
          y: positions.map(p=>p[1]),
          mode: "text", type: "scatter",
          text: agents.map(a=>a.label),
          textfont: { size: 22, color: "#e9eefc" },
          hoverinfo: "none", showlegend:false
        }
      ],
      layout,
      {responsive:true, displayModeBar:false}
    );

    setInterval(tick, intervalMs);
    window.addEventListener('resize', () => Plotly.Plots.resize('chart'));
  </script>
</body>
</html>
